# Отчёт по домашней работе №1: Предсказание стоимости автомобилей

## 1. Что было сделано

### 1.1 EDA и предобработка данных
- загружены train (6999 объектов) и test (1000 объектов) датасеты
- обнаружены и заполнены пропуски медианами (на основе train)
- удалены дубликаты по признаковому описанию (осталось 5840 объектов)
- очищены числовые колонки (mileage, engine, max_power) от единиц измерения
- удален столбец torque для упрощения
- удалены выбросы по цене через IQR метод (осталось 5553 объекта)

### 1.2 Feature Engineering
созданы новые признаки:
- **car_age** - возраст автомобиля (2024 - year)
- **km_per_year** - пробег в год (интенсивность использования)
- **power_per_liter** - мощность на литр объема двигателя
- **brand** - марка авто (извлечена из name)
- **is_premium** - флаг премиум-бренда
- **year_x_power** - взаимодействие года и мощности

### 1.3 Визуализация
- построены pairplot для анализа попарных распределений
- построена тепловая карта корреляций
- boxplot зависимости цены от типа топлива
- гистограммы распределения целевой переменной

### 1.4 Обученные модели
1. LinearRegression (baseline)
2. LinearRegression со стандартизацией
3. Lasso регрессия
4. Lasso с подбором alpha через GridSearchCV
5. ElasticNet с подбором параметров через GridSearchCV
6. Ridge регрессия с категориальными признаками и GridSearchCV

## 2. Результаты

| Модель | R^2 (test) | Business Metric |
|--------|-----------|-----------------|
| Linear Regression | 0.8942 | 30.80% |
| Linear Regression (scaled) | 0.8942 | 30.80% |
| Lasso (default) | -0.1183 | 9.40% |
| Lasso (grid search) | 0.7272 | 27.50% |
| ElasticNet (grid search) | 0.7204 | 26.70% |
| **Ridge + категориальные** | **0.9262** | **36.10%** |

**лучшая модель:** Ridge регрессия с категориальными признаками
- R^2 = 0.9262 (объясняет 92.6% дисперсии)
- бизнес-метрика = 36.10% (прогнозы отличаются от реальных не более чем на 10%)

## 3. Что дало наибольший прирост качества

1. **логарифмирование целевой переменной** - помогло модели лучше работать с ценами разного порядка
2. **добавление категориальных признаков** - дало прирост R^2 на ~0.07, особенно важны fuel и brand
3. **удаление выбросов по цене** - убрало шум из обучающей выборки
4. **feature engineering** - признак year_x_power показал высокую корреляцию с ценой

## 4. Что не удалось и почему

- **lasso с дефолтным alpha=1** занулила все веса - слишком сильная регуляризация для данных
- **столбец torque** не обработан из-за сложного формата (есть значения вида "190Nm@ 2000rpm")
- **бизнес-метрика только 36%** - для продакшена нужно больше признаков или другие модели (деревья, бустинг)

## 5. Оценка разработанного Streamlit-сервиса

### 5.1 Удобство использования
- интуитивный интерфейс с боковой панелью для ввода данных
- поддержка как ручного ввода так и загрузки csv файла
- мгновенное получение предсказания

### 5.2 Что получилось хорошо
- визуализация распределений признаков
- отображение важности признаков через коэффициенты модели
- корреляционная матрица с тепловой картой

### 5.3 Ограничения и проблемы
- модель обучена только на числовых + закодированных категориальных признаках
- при вводе неизвестного бренда используется режим "ignore" в encoder
- нет валидации входных данных на разумность значений

### 5.4 Планируемые улучшения
- добавить валидацию входных данных
- добавить confidence interval для предсказаний
- попробовать градиентный бустинг для улучшения качества
- добавить сохранение истории предсказаний
